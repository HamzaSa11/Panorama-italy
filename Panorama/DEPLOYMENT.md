# Deployment Guide - Railway.app

## Quick Start (5 minutes)

### Step 1: Create Railway Account
1. Go to [railway.app](https://railway.app)
2. Click "Sign Up"
3. Sign up with GitHub (recommended for auto-deployment)

### Step 2: Create New Project
1. Click "Create New Project"
2. Select "Deploy from GitHub repo"
3. Connect your GitHub account if prompted
4. Select your `Panorama-italy` repository
5. Confirm

### Step 3: Add PostgreSQL
1. In Railway dashboard, click "Add Service"
2. Select "PostgreSQL" from the marketplace
3. Railway creates a PostgreSQL instance automatically

### Step 4: Configure Environment Variables
Railway auto-links PostgreSQL, but ensure these variables are set:

1. Go to your project's "Variables" tab
2. The following should already be set by Railway:
   - `DATABASE_URL` (auto-generated by PostgreSQL plugin)

3. Add any additional variables:
   - `PORT` = `5000` (or leave empty for default)
   - `NODE_ENV` = `production`

### Step 5: Update db.js to Use Railway Variables
The app will use these environment variables automatically:
- Railway provides `DATABASE_URL` which includes all connection info
- `db.js` is already configured to read from `.env`

Simply ensure your `.env` matches:
```
DB_HOST=localhost
DB_PORT=5432
DB_NAME=railway
DB_USER=postgres
DB_PASSWORD=your_password
```

Or use the DATABASE_URL from Railway in your connection string.

### Step 6: Deploy
1. Railway auto-deploys when you push to GitHub
2. Watch the logs in the Railway dashboard
3. Once you see "Running", your app is live!

### Step 7: Get Your URL
1. Go to the Deployments tab
2. Copy the public URL (looks like: `https://panorama-italy-production.up.railway.app`)
3. That's your live app!

## Database Migration

After deployment, run migrations on the Railway PostgreSQL instance:

```bash
# From Railway dashboard, open "PostgreSQL" service
# Click "Connect"
# Use the provided connection string
```

Or the database will auto-initialize when the app starts.

## Troubleshooting

### Connection Issues
- Check that PostgreSQL service is running in Railway
- Verify `DATABASE_URL` or connection variables are set
- Check application logs in Railway dashboard

### Port Issues
- Railway automatically sets `PORT` environment variable
- App reads from `.env` or `process.env.PORT`

### Git Push Deploy
- Any push to `main` branch triggers auto-deploy
- Watch the Deployments tab for build status

## Environment Variables Reference

| Variable | Example | Notes |
|----------|---------|-------|
| DB_HOST | localhost | PostgreSQL host |
| DB_PORT | 5432 | PostgreSQL port |
| DB_NAME | Panorama | Database name |
| DB_USER | postgres | PostgreSQL user |
| DB_PASSWORD | xxxxx | PostgreSQL password |
| PORT | 5000 | Server port |
| NODE_ENV | production | Environment type |

## Domain Setup

To use a custom domain:
1. Go to project settings in Railway
2. Add custom domain
3. Update DNS records with provided info
4. Wait for SSL certificate generation

## Support

- Railway Docs: https://docs.railway.app
- Status: https://railway.app/status
