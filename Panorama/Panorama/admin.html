<script>
  // ... (rest of script unchanged until loadClients)

  async function loadClients() {
    try {
      const response = await fetch("/api/admin/clients");
      const data = await response.json();
      const tbody = document.getElementById("clientsBody");
      tbody.innerHTML = "";

      if (data.clients.length === 0) {
        tbody.innerHTML =
          '<tr><td colspan="8" style="text-align: center;">Nessun cliente registrato</td></tr>';
      } else {
        data.clients.forEach((client) => {
          // ✅ FIXED: Show lat,lng only if both exist — else empty
          const locationDisplay = client.locationLat && client.locationLng
            ? `${client.locationLat.toFixed(6)}, ${client.locationLng.toFixed(6)}`
            : "";

          const row = `
          <tr>
            <td>${client.name}</td>
            <td>${client.email}</td>
            <td>${client.phone}</td>
            <td>${client.service}</td>
            <td>${new Date(client.date).toLocaleDateString("it-IT")}</td>
            <td>${locationDisplay}</td>
            <td>${new Date(client.created_at).toLocaleDateString("it-IT")}</td>
            <td><button class="btn-delete" data-client-id="${client.id}">Elimina</button></td>
          </tr>
        `;
          tbody.innerHTML += row;
        });
      }

      // Add event listeners to delete buttons
      document.querySelectorAll(".btn-delete").forEach((btn) => {
        btn.addEventListener("click", () => {
          const clientId = btn.getAttribute("data-client-id");
          deleteClient(clientId);
        });
      });
    } catch (err) {
      document.getElementById("clientsBody").innerHTML =
        '<tr><td colspan="8" style="text-align: center; color: red;">Errore nel caricamento dati</td></tr>';
    }
  }

  // ... rest unchanged
</script>
